#include <criterion/criterion.h>
#include <criterion/new/assert.h>
#include <criterion/redirect.h>
#include <stdio.h>

#include "../src/view.h"

// Check that an empty board prints correctly.
Test(print_board_view, empty_board, .init = cr_redirect_stdout)
{
    char player_board[9][9] = {{' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '}, {' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '}, {' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '}, {' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '}, {' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '}, {' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '}, {' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '}, {' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '}, {' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' '}};
    reset_board(player_board);
    print_board_view(player_board);
    (void)fflush(stdout);
    (void)fclose(stdout);
    cr_assert_stdout_eq_str(
        "    1   2   3   4   5   6   7   8   9"
        "\n  =====================================\n"
        "1 | ' ' : ' ' : ' ' | ' ' : ' ' : ' ' | ' ' : ' ' : ' ' |"
        "\n  |---:---:---|---:---:---|---:---:---|\n"
        "2 | ' ' : ' ' : ' ' | ' ' : ' ' : ' ' | ' ' : ' ' : ' ' |"
        "\n  |---:---:---|---:---:---|---:---:---|\n"
        "3 | ' ' : ' ' : ' ' | ' ' : ' ' : ' ' | ' ' : ' ' : ' ' |"
        "\n  =====================================\n"
        "4 | ' ' : ' ' : ' ' | ' ' : ' ' : ' ' | ' ' : ' ' : ' ' |"
        "\n  |---:---:---|---:---:---|---:---:---|\n"
        "5 | ' ' : ' ' : ' ' | ' ' : ' ' : ' ' | ' ' : ' ' : ' ' |"
        "\n  |---:---:---|---:---:---|---:---:---|\n"
        "6 | ' ' : ' ' : ' ' | ' ' : ' ' : ' ' | ' ' : ' ' : ' ' |"
        "\n  =====================================\n"
        "7 | ' ' : ' ' : ' ' | ' ' : ' ' : ' ' | ' ' : ' ' : ' ' |"
        "\n  |---:---:---|---:---:---|---:---:---|\n"
        "8 | ' ' : ' ' : ' ' | ' ' : ' ' : ' ' | ' ' : ' ' : ' ' |"
        "\n  |---:---:---|---:---:---|---:---:---|\n"
        "9 | ' ' : ' ' : ' ' | ' ' : ' ' : ' ' | ' ' : ' ' : ' ' |"
        "\n  =====================================\n");
}
